<!DOCTYPE html>
<html lang="fr">
<head>
  $(if refresh-timeout)
  <meta http-equiv="refresh" content="$(refresh-timeout-secs)">
  $(endif)
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="expires" content="-1">
  <title>Dnet - Statut de la Connexion</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />
  <script>
    $(if advert-pending == 'yes')
      var popup = '';
      function focusAdvert() { if (window.focus) popup.focus(); }
      function openAdvert() {
        popup = open('$(link-advert)', 'hotspot_advert', '');
        setTimeout("focusAdvert()", 1000);
      }
    $(endif)
    function openLogout() {
      if (window.name != 'hotspot_status') return true;
      open('$(link-logout)', 'hotspot_logout',
        'toolbar=0,location=0,status=0,menubars=0,width=280,height=250');
      window.close();
      return false;
    }
  </script>
  <style>
    /* ... même style que la version précédente, raccourci ici pour lisibilité ... */
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(45deg, #e6f9f4, #f0f4f8);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 20px;
      color: #212529;
    }
    .main-container {
      max-width: 1100px;
      width: 100%;
      background: white;
      border-radius: 20px;
      box-shadow: 0 15px 40px rgba(0,0,0,0.08);
      display: flex;
      overflow: hidden;
    }
    .welcome-panel {
      flex-basis: 45%;
      background: #19c394;
      color: white;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 60px 40px;
      text-align: center;
    }
    .welcome-panel img { max-width: 180px; margin-bottom: 25px; filter: brightness(0) invert(1); }
    .status-panel {
      flex-basis: 55%;
      padding: 50px 60px;
    }
    .status-header {
      margin-bottom: 30px;
      display: flex;
      align-items: center;
      gap: 15px;
      justify-content: center;
    }
    .status-header svg {
      width: 50px; height: 50px; color: #19c394;
    }
    .stats-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 30px;
    }
    .stat-card {
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      padding: 20px;
      border-radius: 12px;
    }
    .stat-card .label { font-size: 0.9rem; color: #6c757d; font-weight: 600; margin-bottom: 5px; }
    .stat-card .value { font-size: 1.3rem; font-weight: bold; word-break: break-word; }
    .logout-button {
      width: 100%;
      padding: 15px;
      font-size: 1.1rem;
      background: #dc3545;
      color: white;
      border: none;
      border-radius: 12px;
      cursor: pointer;
    }
    .logout-button:hover {
      background: #b02a37;
    }
    .footer-note {
      font-size: 0.9rem;
      color: #6c757d;
      margin-top: 20px;
    }
    @media (max-width: 768px) {
      .main-container { flex-direction: column; }
      .welcome-panel { display: none; }
      .status-panel { padding: 30px 20px; }
      .stats-grid { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body $(if advert-pending == 'yes') onLoad="openAdvert()" $(endif)>
  <div class="main-container">
    <div class="welcome-panel">
      <img src="logo-dnet.png" alt="Logo Dnet" />
      <h1>Vous êtes Connecté !</h1>
      <p>Profitez de notre connexion haut débit. Votre session est maintenant active.</p>
    </div>
    <div class="status-panel">
      <header class="status-header">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor"
             stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             viewBox="0 0 24 24">
          <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
          <polyline points="22 4 12 14.01 9 11.01"></polyline>
        </svg>
        <div>
          <h2>Statut de la session</h2>
          <p>Bienvenue $(username)</p>
        </div>
      </header>

      <div class="stats-grid">
        <div class="stat-card">
          <div class="label">Adresse IP</div>
          <div class="value">$(ip)</div>
        </div>
        <div class="stat-card">
          <div class="label">Données</div>
          <div class="value">$(bytes-in-nice) / $(bytes-out-nice)</div>
        </div>
        <div class="stat-card">
          <div class="label">Durée de session</div>
          <div class="value">$(uptime)</div>
        </div>
        $(if session-time-left)
        <div class="stat-card">
          <div class="label">Temps restant</div>
          <div class="value">$(session-time-left)</div>
        </div>
        $(endif)
        $(if refresh-timeout)
        <div class="stat-card">
          <div class="label">Rafraîchissement</div>
          <div class="value">$(refresh-timeout)</div>
        </div>
        $(endif)
        $(if blocked == 'yes')
        <div class="stat-card">
          <div class="label">Publicité requise</div>
          <div class="value"><a href="$(link-advert)" target="hotspot_advert">Cliquez ici</a></div>
        </div>
        $(endif)
      </div>

      <form action="$(link-logout)" name="logout" onsubmit="return openLogout()">
        <input type="submit" value="Se Déconnecter" class="logout-button" />
      </form>

      <p class="footer-note">Vous pouvez fermer cette page et commencer à naviguer.</p>
    </div>
  </div>
</body>
</html>
